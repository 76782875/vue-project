webpackJsonp([7],{"5yx+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("NYxO"),s=a("Dd8w"),l=a.n(s),i=a("pXgp"),r={name:"getWebSocket",data:function(){return{socketDatatext:"",socketStatus:"",guanbi:!1,socketSchedule:70}},computed:l()({},Object(o.c)({dialoggetWebSocket:function(e){return e.dialoggetWebSocket}})),watch:{$route:function(e,t){console.log(e),"/orderReceivable"==e.fullPath&&"/verifyAutomate"!=t.fullPath&&"/verifyReceivablesRecord"!=t.fullPath&&this.websockets(),"/verifyReceivablesRecord"==e.fullPath&&"/orderReceivable"==t.fullPath&&this.close(),"/verifyAutomate"==e.fullPath&&("/transactionFlow"==t.fullPath&&this.close(),this.websockets()),"/orderUpload"==t.fullPath&&this.close(),"/verifyAutomate"==t.fullPath&&"/transactionFlow"==e.fullPath&&this.close()}},created:function(){this.websockets()},methods:{websockets:function(){var e=localStorage.getItem("socket"),t=this,a=new WebSocket(i.a.ws+"/ws");"open"!=e&&(a.onopen=function(e){console.log("open websocket"),localStorage.setItem("socket","open"),a.send("Holle")}),a.onmessage=function(e){JSON.parse(e.data);JSON.parse(e.data)!={}&&""!=JSON.parse(e.data)&&"undefined "!=JSON.parse(e.data)&&(t.socketSchedule=parseFloat(JSON.parse(e.data).process)),t.socketStatus=JSON.parse(e.data).status,t.socketDatatext=JSON.parse(e.data).text,"Ongoing"===JSON.parse(e.data).status?t.guanbi=!0:t.guanbi=!1},a.onclose=function(e){localStorage.setItem("socket","close"),console.log(" clsoe websocket")},this.$router.afterEach(function(){localStorage.setItem("socket","close"),a.close()}),this.close=function(){localStorage.setItem("socket","close"),a.close()}},shutDown:function(){},cancel:function(){this.$store.dispatch("dialoggetWebSocket")},determine:function(){this.$store.dispatch("dialoggetWebSocket"),this.$emit("socketStatus",this.guanbi),this.socketDatatext="",this.socketStatus="",this.guanbi=!1,this.socketSchedule=0},dialog_close:function(){this.$store.dispatch("dialoggetWebSocket")},getCookie:function(e){e+="=";var t=document.cookie.indexOf(e),a=null;if(t>-1){var o=document.cookie.indexOf(";",t);-1==o&&(o=document.cookie.length),a=document.cookie.substring(t+e.length,o)}return a}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"batch-statement"},[[a("el-dialog",{staticStyle:{"min-height":"100px"},attrs:{width:"42%",title:"提示","close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,visible:e.dialoggetWebSocket,"before-close":e.dialog_close,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialoggetWebSocket=t}}},[a("div",{staticClass:"progressClass"},[a("el-progress",{attrs:{"text-inside":!0,status:"socketStatus","stroke-width":18,percentage:e.socketSchedule}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px",height:"15px","text-align":"center"}},[e._v(e._s(e.socketDatatext))]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary",disabled:e.guanbi},on:{click:e.determine}},[e._v("确 定")])],1)])]],2)},staticRenderFns:[]};var n={name:"verifyAutomate",components:{getWebSocket:a("VU/8")(r,c,!1,function(e){a("IOxy")},"data-v-18c2ba98",null).exports},data:function(){return{disabled:!0,radio:"1",dialogVisible:!1,rulesId:"",form:{time:"",platform:""},options:[{value:"1",label:"支付宝"},{value:"2",label:"微信"},{value:"3",label:"天猫"},{value:"5",label:"京东"},{value:"9",label:"美团"}],value5:[],ruleList:[{id:"1",name:"方案一"},{id:"2",name:"方案二"}]}},methods:{rowClickPayment:function(e){console.log(e.id),this.rulesId=e.id,this.$refs.orderTable.toggleRowSelection(e),this.radio=this.ruleList.indexOf(e)},getCurrentRow:function(e){console.log(e)},changeDisabled:function(){this.disabled=!this.disabled},clickAuto:function(){return""==this.form.platform?(this.$message.error({message:"请选择平台",center:!0}),!1):""===this.form.time?(this.$message.error({message:"请选择业务日期",center:!0}),!1):""===this.rulesId?(this.$message.error({message:"请选择对账规则",center:!0}),!1):void this.$store.dispatch("dialoggetWebSocket")}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"verify-automate"},[a("h3",{staticClass:"head_title"},[e._v("自动对账")]),e._v(" "),a("getWebSocket"),e._v(" "),[a("el-row",[a("el-button",{attrs:{size:"mini",type:"primary",disabled:!e.disabled},on:{click:e.changeDisabled}},[e._v("收款对账")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",disabled:e.disabled},on:{click:e.changeDisabled}},[e._v("退款对账")])],1)],e._v(" "),[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("h3",[e._v("参数选择")]),e._v(" "),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-col",{attrs:{md:24}},[a("el-form-item",{attrs:{label:"平台:"}},[a("el-select",{attrs:{size:"small",multiple:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.form.platform,callback:function(t){e.$set(e.form,"platform",t)},expression:"form.platform"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:24}},[a("el-form-item",{attrs:{label:"参与核销单据的业务日期小于等于:"}},[a("el-date-picker",{attrs:{size:"small",type:"date",placeholder:"选择日期时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:24}},[a("el-form-item",{attrs:{label:"自动产生对账记录的对账日期为:"}},[a("el-date-picker",{attrs:{size:"small",type:"date",placeholder:"选择日期时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("h3",[e._v("规则选择")]),e._v(" "),a("el-form",{attrs:{model:e.form}},[a("el-row",[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("上移")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("下移")])],1)],1),e._v(" "),[a("el-table",{ref:"orderTable",staticStyle:{"margin-top":"10px"},attrs:{border:"",data:e.ruleList,"highlight-current-row":"","max-height":"164","tooltip-effect":"dark"},on:{"row-click":e.rowClickPayment}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"对账方案"}}),e._v(" "),a("el-table-column",{attrs:{label:"选中",width:"136"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{staticClass:"radio",attrs:{label:t.$index},nativeOn:{change:function(a){e.getCurrentRow(t.$index)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" ")])]}}])})],1)]],2)],1)],1)],e._v(" "),a("div",{staticClass:"execute-btn"},[a("el-row",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.clickAuto}},[e._v("执行对账")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("退出")])],1)],1)],2)},staticRenderFns:[]};var u=a("VU/8")(n,d,!1,function(e){a("edh6")},"data-v-ba0f318c",null);t.default=u.exports},IOxy:function(e,t){},edh6:function(e,t){}});
//# sourceMappingURL=7.883bcaaeaea3efbf8c13.js.map